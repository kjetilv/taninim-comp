{"version":3,"sources":["taninim/views/library.cljs"],"mappings":";AAIA,mCAAA,nCAAOA,8EAAYC;AAAnB,AACE,6DAAA,tDAACC,iKAAe,AAAA,2FAAWD;;AAE7B,mCAAA,nCAAME,8EAAYF,MAAMG;AAAxB,AACE,IAAMC,gBAAQ,AAACC,0BAAUF,cAAc,AAAA,oFAAOH;AAA9C,AAAA,0FAAA,yEAAA,2CAAA,gGAAA,mFAAA,6KAAA,mFAAA,kLAAA,mFAAA,hoBAC2B,iBAAA,AAAA,SAAA,xBAAMI,oMACZ,AAAA,mFAAOJ,+KACN,AAAA,sFAASA,8KACT,uGAAA,1DAAK,AAACM,gBAAM,AAACP,iCAAWC,qCAC3C,iBAAA,mFAAA,yDAAA,2CAAA,6DAAA,nQAAII;AAAJ,AACuB,8BAAA,mFAAA,1GAACG,+KAA4B,AAAA,oFAAOP;WAD3D,kBAAA,mFAAA,yDAAA,2CAAA,6DAAA;AAAA,AAEuB,8BAAA,mFAAA,1GAACO,8KAA4B,AAAA,oFAAOP;WAF3D,mBAGA,iBAAA,AAAA,gIAAA,/IAAMI,kGACHI,+BAAiBR;;AAEzB,qCAAA,rCAAMS;AAAN,AACE,uBAAA,mFAAA,1GAACF;;AACD;AAAA,AACE,aAAA,AAAAG,TAAMC,yBAAQ,sDAAA,mFAAA,zIAACC;qBAAf,AAAAF,jBACMG,iCAAU,sDAAA,mFAAA,zIAACD;oBADjB,AAAAF,hBAEMP,gCAAe,sDAAA,mFAAA,zIAACS;AAFtB,AAAA,0FAAA,mEAAA,mFAAA,iDAAA,kBAKG,kCAAA,mFAAA,mEAAA,6BAAA,mFAAA,tRAAIC,+VAGD,iBAAAC,qBAAA,2DAAAC;AAAA,AAAA,YAAAC,kBAAA,KAAA;AAAA,AAAA,IAAAD,eAAAA;;AAAA,AAAA,IAAAE,qBAAA,AAAAC,cAAAH;AAAA,AAAA,GAAAE;AAAA,AAAA,IAAAF,eAAAE;AAAA,AAAA,GAAA,AAAAE,6BAAAJ;AAAA,IAAAK,kBAu7EyC,AAAAc,sBAAAnB;IAv7EzCM,qBAAA,AAAAf,gBAAAc;IAAAE,WAAA,AAAAC,uBAAAF;AAAA,AAAA,GAAA,AAAA,iBAAAG,WAAA;;AAAA,AAAA,GAAA,CAAAA,WAAAH;AAAA,YAAA,AAAAI,eAAAL,gBAAAI,vCAAMxB;AAAN,AAAA,AAAA,AAAA0B,uBAAAJ,SAAA,oBAAA,gJAAA,2CAAA,oDACS,AAAA,oFAAOtB,hPACbE,iCAAWF,MAAMG;;AAFpB,eAAA,CAAAqB,WAAA;;;;AAAA;;;;;AAAA,OAAAG,qBAAA,AAAAC,gBAAAN,UAAA,AAAAO,iDAAA,AAAAC,qBAAAf;;AAAA,OAAAY,qBAAA,AAAAC,gBAAAN,UAAA;;;AAAA,YAAA,AAAAS,gBAAAhB,xBAAMf;AAAN,AAAA,OAAAgC,eAAA,oBAAA,gJAAA,2CAAA,wJAAA,AAAAH,iDAAA,AAAAI,eAAAlB,pKACS,AAAA,oFAAOf,hPACbE,iCAAWF,MAAMG;;;AAFpB;;;;GAAA,KAAA;;AAAA,AAAA,OAAAW,mBAAYH","names":["taninim.views.library/all-tracks","album","cljs.core.mapcat","taninim.views.library/album-card","active-leases","leased?","cljs.core/contains?","cljs.core/count","re-frame.core/dispatch","taninim.views.album/track-list","taninim.views.library/library-view","cljs.core/deref","albums","re_frame.core.subscribe","loading?","iter__5480__auto__","s__12591","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","b__12593","cljs.core/chunk-buffer","i__12592","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__12590","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","cljs.core/chunk-first"],"sourcesContent":["(ns taninim.views.library\n  (:require [re-frame.core :as rf]\n            [taninim.views.album :as album]))\n\n(defn- all-tracks [album]\n  (mapcat :tracks (:sections album)))\n\n(defn album-card [album active-leases]\n  (let [leased? (contains? active-leases (:uuid album))]\n    [:div.album-card {:class (when leased? \"leased\")}\n     [:div.album-title (:name album)]\n     [:div.album-artist (:artist album)]\n     [:div.album-tracks (str (count (all-tracks album)) \" tracks\")]\n     (if leased?\n       [:button {:on-click #(rf/dispatch [:lease/release (:uuid album)])} \"Release\"]\n       [:button {:on-click #(rf/dispatch [:lease/acquire (:uuid album)])} \"Acquire\"])\n     (when leased?\n       [album/track-list album])]))\n\n(defn library-view []\n  (rf/dispatch [:library/fetch])\n  (fn []\n    (let [albums @(rf/subscribe [:albums])\n          loading? @(rf/subscribe [:library-loading?])\n          active-leases @(rf/subscribe [:active-leases])]\n      [:div.library\n       [:h2 \"Library\"]\n       (if loading?\n         [:div.loading \"Loading library...\"]\n         [:div.album-grid\n          (for [album albums]\n            ^{:key (:uuid album)}\n            [album-card album active-leases])])])))\n"]}